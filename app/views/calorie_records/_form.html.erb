<%= form_with model: calorie_record, local: true do |f| %>
  <%= f.hidden_field :meal_type, value: calorie_record.meal_type %>

  <div class="flex flex-wrap items-end gap-4">

    <div class="w-full sm:w-auto">
      <%= f.label :base_calorie, "カロリー", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <div class="flex items-center gap-2">
        <%= f.number_field :base_calorie,
              inputmode: "numeric",
              placeholder: "例：650",
              class: "w-full sm:w-32 rounded-xl bg-white/50 border border-white/30 px-4 py-3 text-sm shadow-sm
                      focus:outline-none focus:ring-2 focus:ring-indigo-400" %>
        <span class="text-gray-700 text-sm">kcal</span>
      </div>
    </div>

    <!-- ご飯 -->
    <% unless calorie_record.meal_type == "snack" %>
    <div class="w-full sm:w-auto">
      <%= f.label :rice_bowls, class: "block text-sm font-medium text-gray-700 mb-1" do %>
        <% if calorie_record.persisted? %>
          <span class="text-gray-500 font-normal">ご飯 <%= calorie_record.rice_bowls %>杯 = <%= (calorie_record.rice_bowls.to_f * @rice_kcal_per_bowl).round %> kcal</span>
        <% else %>
          ご飯(杯) <span class="text-gray-500 font-normal"><%= @rice_kcal_per_bowl %> kcal/杯</span>
        <% end %>
      <% end %>
      <%= f.number_field :rice_bowls, min: 0, placeholder: "1",
            value: calorie_record.persisted? ? calorie_record.rice_bowls : 1,
            class: "w-full sm:w-24 rounded-xl bg-white/50 border border-white/30 px-4 py-3 text-sm shadow-sm
                    focus:outline-none focus:ring-2 focus:ring-indigo-400" %>
    </div>
  <% end %>
    <!-- メモ -->
    <div class="flex-1 min-w-40 w-full">
      <%= f.label :memo, "メモ", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= f.text_field :memo, placeholder: "例：外食した",
            class: "w-full rounded-xl bg-white/50 border border-white/30 px-4 py-3 text-sm shadow-sm
                    focus:outline-none focus:ring-2 focus:ring-indigo-400" %>
    </div>

    <!-- ボタン -->
    <div class="w-full sm:w-auto">
      <%= f.submit(calorie_record.persisted? ? "更新する" : "記録",
            class: "w-full sm:w-auto px-6 py-3 rounded-xl bg-indigo-600/90 text-white text-sm font-medium shadow-lg
                    hover:bg-indigo-500 transition focus:outline-none focus:ring-2 focus:ring-indigo-300") %>
    </div>
  </div>
<% end %>